bash conditions loops and parsing